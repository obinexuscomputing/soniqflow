<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SoniqSound Demo</title>
    <script src="../dist/index.umd.js" defer></script>
    <script>
        let soniq;

        document.addEventListener("DOMContentLoaded", () => {
            const setupButton = document.getElementById("setup-audio");
            const buttons = document.querySelectorAll(".action-button");

            setupButton.addEventListener("click", () => {
                const seed = 12345;
                soniq = new SoniqWave.SoniqSound(seed);

                // Resume AudioContext explicitly
                SoniqWave.sharedAudioContext.resume().then(() => {
                    console.log("AudioContext resumed successfully.");
                    setupButton.disabled = true;
                    buttons.forEach(button => button.disabled = false);
                }).catch(error => {
                    console.error("Error resuming AudioContext:", error);
                });
            });

            // Set up action buttons
            document.getElementById("play-harmonic").addEventListener("click", () => {
                soniq.playHarmonicWave({
                    baseFrequency: 440,
                    harmonics: [1, 2, 3, 4],
                    amplitudes: [1.0, 0.8, 0.6, 0.4],
                    canvas: document.getElementById("visualization")
                });
            });

            document.getElementById("play-instrument").addEventListener("click", () => {
                soniq.playInstrument("piano", 440, 2.5); // Play A4 for 2.5 seconds
            });

            document.getElementById("play-noise").addEventListener("click", () => {
                soniq.generateAndPlayNoise("white", 1024, 440, [1, 2], [1, 0.5]);
            });

            document.getElementById("stop-all").addEventListener("click", () => {
                soniq.stopAll();
            });

            // Initially disable action buttons until AudioContext is resumed
            buttons.forEach(button => button.disabled = true);
        });
    </script>
</head>
<body>
    <h1>SoniqSound Demo</h1>
    <button id="setup-audio">Setup Audio</button>
    <button id="play-harmonic" class="action-button">Play Harmonic Wave</button>
    <button id="play-instrument" class="action-button">Play Instrument</button>
    <button id="play-noise" class="action-button">Play Noise</button>
    <button id="stop-all" class="action-button">Stop All Playback</button>

    <p>Harmonic wave visualization:</p>
    <canvas id="visualization" width="800" height="400" style="border: 1px solid black;"></canvas>
</body>
</html>
